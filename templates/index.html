{% extends 'base.html' %}

{% block title %}文章列表 - 簡易部落格{% endblock %}

{% block content %}
  <h1>文章列表</h1>
  <p><a class="btn btn-primary" href="{{ url_for('new_post') }}">新增文章</a></p>

  <div id="posts-list">
    <p>載入中…</p>
  </div>

  <script>
    async function loadPosts() {
      const res = await fetch('/api/posts');
      const posts = await res.json();
      const container = document.getElementById('posts-list');
      if (!posts.length) {
        container.innerHTML = '<p>目前沒有文章。</p>';
        return;
      }
      const html = posts.map(p => `
        <a href="/post/${p.id}" class="list-group-item list-group-item-action">
          <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">${p.title}</h5>
            <small>by ${p.author}</small>
          </div>
          <p class="mb-1 text-truncate">${p.content}</p>
        </a>
      `).join('');
      container.innerHTML = `<div class="list-group">${html}</div>`;
    }
    loadPosts();
  </script>
{% endblock %}
